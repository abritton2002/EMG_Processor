=============================================== 
EMG Pipeline Run - Thu 05/01/2025 10:15:53.03 
=============================================== 
Using data directory: M:\EMG_DATA_new 
Using Python: C:\Python312\python.exe 
Python 3.12.4
Installing required packages... 
Could not find platform independent libraries <prefix>
Requirement already satisfied: numpy==1.26.4 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 1)) (1.26.4)
Requirement already satisfied: pandas==2.1.4 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 2)) (2.1.4)
Requirement already satisfied: matplotlib==3.8.0 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 3)) (3.8.0)
Requirement already satisfied: python-utils>=3.4.5 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 4)) (3.9.1)
Requirement already satisfied: xarray in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 5)) (2025.3.1)
Requirement already satisfied: contourpy in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 6)) (1.3.2)
Requirement already satisfied: python-dotenv==1.1.0 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 7)) (1.1.0)
Requirement already satisfied: tkcalendar==1.6.1 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 8)) (1.6.1)
Requirement already satisfied: mysql-connector-python in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 9)) (9.3.0)
Requirement already satisfied: scipy in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 10)) (1.15.2)
Requirement already satisfied: scikit-learn in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 11)) (1.6.1)
Requirement already satisfied: pymysql in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 12)) (1.1.1)
Requirement already satisfied: PyWavelets in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 13)) (1.8.0)
Requirement already satisfied: babel==2.17.0 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 14)) (2.17.0)
Requirement already satisfied: seaborn>=0.12.0 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 15)) (0.13.2)
Requirement already satisfied: sqlalchemy>=2.0.0 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from -r requirements.txt (line 16)) (2.0.40)
Requirement already satisfied: python-dateutil>=2.8.2 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from pandas==2.1.4->-r requirements.txt (line 2)) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from pandas==2.1.4->-r requirements.txt (line 2)) (2025.2)
Requirement already satisfied: tzdata>=2022.1 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from pandas==2.1.4->-r requirements.txt (line 2)) (2025.2)
Requirement already satisfied: cycler>=0.10 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from matplotlib==3.8.0->-r requirements.txt (line 3)) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from matplotlib==3.8.0->-r requirements.txt (line 3)) (4.57.0)
Requirement already satisfied: kiwisolver>=1.0.1 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from matplotlib==3.8.0->-r requirements.txt (line 3)) (1.4.8)
Requirement already satisfied: packaging>=20.0 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from matplotlib==3.8.0->-r requirements.txt (line 3)) (25.0)
Requirement already satisfied: pillow>=6.2.0 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from matplotlib==3.8.0->-r requirements.txt (line 3)) (11.2.1)
Requirement already satisfied: pyparsing>=2.3.1 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from matplotlib==3.8.0->-r requirements.txt (line 3)) (3.2.3)
Requirement already satisfied: typing_extensions>3.10.0.2 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from python-utils>=3.4.5->-r requirements.txt (line 4)) (4.13.2)
Requirement already satisfied: joblib>=1.2.0 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from scikit-learn->-r requirements.txt (line 11)) (1.4.2)
Requirement already satisfied: threadpoolctl>=3.1.0 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from scikit-learn->-r requirements.txt (line 11)) (3.6.0)
Requirement already satisfied: greenlet>=1 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from sqlalchemy>=2.0.0->-r requirements.txt (line 16)) (3.2.1)
Requirement already satisfied: six>=1.5 in c:\users\alex.britton\documents\delsystesting\v2_repo\lib\site-packages (from python-dateutil>=2.8.2->pandas==2.1.4->-r requirements.txt (line 2)) (1.17.0)
---------------------------------------- 
Testing and initializing database tables... 
Could not find platform independent libraries <prefix>
Database tables initialized successfully 
---------------------------------------- 
Running EMG pipeline... 
Could not find platform independent libraries <prefix>
2025-05-01 10:15:56,849 - __main__ - INFO - Starting pipeline run at 2025-05-01 10:15:56.849145
2025-05-01 10:15:56,851 - emg_processor - INFO - EMG Processor initialized
2025-05-01 10:15:56,851 - db_connector - INFO - Database connector initialized
2025-05-01 10:15:56,851 - emg_pipeline - INFO - EMG Pipeline initialized with data directory: M:\EMG_DATA_new
2025-05-01 10:15:56,852 - emg_pipeline - INFO - Using batch size of 1000 for DB operations
2025-05-01 10:15:56,852 - emg_pipeline - INFO - Processing directory: M:\EMG_DATA_new (recursive=True)
2025-05-01 10:15:57,252 - db_connector - INFO - Connected to database theia_pitching_db
2025-05-01 10:15:57,731 - db_connector - INFO - Connected to database theia_pitching_db
2025-05-01 10:15:57,970 - db_connector - INFO - Database tables created/verified successfully
2025-05-01 10:15:57,970 - __main__ - ERROR - Error processing directory M:\EMG_DATA_new: Already closed
2025-05-01 10:15:58,016 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\alex.britton\Documents\DelsysTesting\V2_REPO\main.py", line 171, in main
    summary = pipeline.process_directory(dir_path, args.recursive)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\alex.britton\Documents\DelsysTesting\V2_REPO\emg_pipeline.py", line 1206, in process_directory
    if not self.setup_database():
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\alex.britton\Documents\DelsysTesting\V2_REPO\emg_pipeline.py", line 109, in setup_database
    self.db.disconnect()
  File "C:\Users\alex.britton\Documents\DelsysTesting\V2_REPO\db_connector.py", line 81, in disconnect
    self.conn.close()
  File "C:\Users\alex.britton\Documents\DelsysTesting\V2_REPO\Lib\site-packages\pymysql\connections.py", line 414, in close
    raise err.Error("Already closed")
pymysql.err.Error: Already closed

2025-05-01 10:15:58,016 - __main__ - INFO - Pipeline run completed at 2025-05-01 10:15:58.016773
Error: Pipeline failed with exit code 1 
=============================================== 
Pipeline run completed at Thu 05/01/2025 10:15:58.15 
=============================================== 
